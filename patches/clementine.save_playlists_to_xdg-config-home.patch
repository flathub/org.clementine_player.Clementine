From b62ef6bffe7a98a147cb66d72293f2f8c18a8183 Mon Sep 17 00:00:00 2001
From: "Shawn W. Dunn" <sfalken@cloverleaf-linux.org>
Date: Mon, 8 Apr 2024 07:55:06 -0700
Subject: [PATCH] Rebase clementine.save_playlists_to_xdg-config-home.patch

---
 src/core/utilities.cpp | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/src/core/utilities.cpp b/src/core/utilities.cpp
index 5541b3d57..cb52c60c6 100644
--- a/src/core/utilities.cpp
+++ b/src/core/utilities.cpp
@@ -355,6 +355,14 @@ QString GetConfigPath(ConfigPath config) {
 #ifdef Q_OS_DARWIN
       return mac::GetApplicationSupportPath() + "/" +
              QCoreApplication::organizationName();
+#elif defined(Q_OS_UNIX) && !defined(Q_OS_DARWIN)
+      char* xdg = getenv("XDG_CONFIG_HOME");
+      if (!xdg || !*xdg) {
+        return QString("%1/.config/%2")
+          .arg(QDir::homePath(), QCoreApplication::organizationName());
+      } else {
+        return QString("%1/%2").arg(xdg, QCoreApplication::organizationName());
+      }
 #else
       return QString("%1/%2").arg(
           QStandardPaths::writableLocation(QStandardPaths::ConfigLocation),
-- 
2.44.0

